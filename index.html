<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Susil Store | Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- =======================
     GOOGLE FONT
======================= -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- =======================
     FONT AWESOME
======================= -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* =========================
   GLOBAL RESET
========================= */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Poppins',sans-serif;
}

/* =========================
   BODY
========================= */
body{
    min-height:100vh;
    background:linear-gradient(135deg,#ff6a00,#ff9f00);
    display:flex;
    justify-content:center;
    align-items:center;
}

/* =========================
   MAIN CARD
========================= */
.container{
    width:100%;
    max-width:420px;
    background:#fff;
    border-radius:16px;
    padding:30px;
    box-shadow:0 20px 40px rgba(0,0,0,0.2);
}

/* =========================
   HEADER
========================= */
.header{
    text-align:center;
    margin-bottom:25px;
}

.header h1{
    font-size:26px;
    font-weight:600;
}

.header p{
    color:#666;
    font-size:14px;
}

/* =========================
   GOOGLE BUTTON
========================= */
.google-btn{
    width:100%;
    padding:14px;
    border-radius:10px;
    border:1px solid #ddd;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    cursor:pointer;
    font-weight:500;
    background:#fff;
    transition:0.3s;
}

.google-btn:hover{
    background:#f7f7f7;
}

/* =========================
   USER PROFILE
========================= */
.profile{
    display:none;
    text-align:center;
}

.profile img{
    width:90px;
    height:90px;
    border-radius:50%;
    margin-bottom:10px;
}

.profile h2{
    font-size:20px;
}

.profile p{
    font-size:14px;
    color:#555;
}

.logout{
    margin-top:20px;
    padding:12px;
    width:100%;
    background:#ff3b3b;
    color:#fff;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:15px;
}

/* =========================
   FOOTER
========================= */
.footer{
    text-align:center;
    margin-top:20px;
    font-size:13px;
    color:#777;
}
</style>
</head>

<body>

<div class="container">

    <!-- LOGIN SECTION -->
    <div id="loginBox">
        <div class="header">
            <h1>Login</h1>
            <p>Continue with Google</p>
        </div>

        <button class="google-btn" id="googleLogin">
            <i class="fab fa-google"></i>
            Continue with Google
        </button>
    </div>

    <!-- PROFILE SECTION -->
    <div class="profile" id="profileBox">
        <img id="userPhoto" src="">
        <h2 id="userName"></h2>
        <p id="userEmail"></p>
        <button class="logout" id="logoutBtn">Logout</button>
    </div>

    <div class="footer">
        Â© 2026 Susil Store. All rights reserved.
    </div>

</div>

<!-- =======================
     FIREBASE SDK v9
======================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import {
  getAuth,
  GoogleAuthProvider,
  signInWithPopup,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import {
  getFirestore,
  doc,
  setDoc,
  getDoc
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

/* =======================
   FIREBASE CONFIG
======================= */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "susil-store.firebaseapp.com",
  projectId: "susil-store",
  storageBucket: "susil-store.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

/* =======================
   INIT FIREBASE
======================= */
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

/* =======================
   ELEMENTS
======================= */
const loginBox = document.getElementById("loginBox");
const profileBox = document.getElementById("profileBox");
const googleLogin = document.getElementById("googleLogin");
const logoutBtn = document.getElementById("logoutBtn");

/* =======================
   GOOGLE LOGIN
======================= */
googleLogin.addEventListener("click", async () => {
  try {
    const result = await signInWithPopup(auth, provider);
    const user = result.user;

    // Save user uniquely by UID
    await setDoc(doc(db, "users", user.uid), {
      name: user.displayName,
      email: user.email,
      photo: user.photoURL,
      lastLogin: new Date()
    }, { merge: true });

  } catch (error) {
    alert("Google login failed: " + error.message);
  }
});

/* =======================
   AUTH STATE
======================= */
onAuthStateChanged(auth, async (user) => {
  if (user) {
    loginBox.style.display = "none";
    profileBox.style.display = "block";

    const userDoc = await getDoc(doc(db, "users", user.uid));
    const data = userDoc.data();

    document.getElementById("userName").innerText = data.name;
    document.getElementById("userEmail").innerText = data.email;
    document.getElementById("userPhoto").src = data.photo;

  } else {
    loginBox.style.display = "block";
    profileBox.style.display = "none";
  }
});

/* =======================
   LOGOUT
======================= */
logoutBtn.addEventListener("click", async () => {
  await signOut(auth);
});
</script>

</body>
</html>
